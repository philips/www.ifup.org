(function(e){e.TableOfContents=function(t,s,l){var i=this;return self.$el=e(t),self.el=t,self.toc="",self.listStyle=null,self.tags=["h1","h2","h3","h4","h5","h6"],self.init=function(){self.options=e.extend({},e.TableOfContents.defaultOptions,l),(s===void 0||null==s)&&(s=document.body),self.$scope=e(s);var t=self.$scope.find(self.tags.join(", ")).filter(":first");if(1==t.length){self.starting_depth=self.options.startLevel,1>self.options.depth&&(self.options.depth=1);var n=self.tags.splice(self.options.startLevel-1,self.options.depth);if(self.$headings=self.$scope.find(n.join(", ")),self.options.topLinks!==!1){var o=e(document.body).attr("id");""==o&&(o=self.options.topBodyId,document.body.id=o),self.topLinkId=o}return self.$el.is("ul")?self.listStyle="ul":self.$el.is("ol")&&(self.listStyle="ol"),self.buildTOC(),self.options.proportionateSpacing!==!0||self.tieredList()||self.addSpacing(),i}},self.tieredList=function(){return self.options.tieredList===!1?!1:"ul"==self.listStyle||"ol"==self.listStyle},self.buildTOC=function(){self.current_depth=self.starting_depth,self.$headings.each(function(e){var t=this.nodeName.toLowerCase().substr(1,1);(e>0||0==e&&t!=self.current_depth)&&self.changeDepth(t),self.toc+=self.formatLink(this,t,e)+"\n",self.options.topLinks!==!1&&self.addTopLink(this)}),self.changeDepth(self.starting_depth,!0),self.toc="<li>\n"+self.toc+"</li>\n",self.$el.html(self.toc)},self.addTopLink=function(t){var s=self.options.topLinks===!0?"Top":self.options.topLinks,l=e("<a href='#"+self.topLinkId+"' class='"+self.options.topLinkClass+"'></a>").html(s);e(t).append(l)},self.formatLink=function(t,s){var l=t.id,i=e(t).text();""==l&&(l=self.buildSlug(e(t).text()),t.id=l),self.options.linkifyHeaders&&(e(t).empty(),e(t).append("<a href='#"+l+"'>"+i+"</a>"));var n="<a href='#"+l+"'";return self.tieredList()||(n+=" class='"+self.depthClass(s)+"'"),n+=">"+self.options.levelText.replace("%",e(t).text())+"</a>"},self.changeDepth=function(e,t){if(t!==!0&&(t=!1),e>self.current_depth){var s=[];if(self.tieredList())for(var l=self.current_depth;e>l;l++)s.push("<"+self.listStyle+">"+"\n");var i="<li>\n";self.toc+=s.join(i)+i}else if(self.current_depth>e){var n=[];if(self.tieredList())for(var l=self.current_depth;l>e;l--)n.push("</"+self.listStyle+">"+"\n");self.toc+="</li>\n"+n.join("</li>\n"),t||(self.toc+="</li>\n<li>\n")}else t||(self.toc+="</li>\n<li>\n");self.current_depth=e},self.buildSlug=function(e){return e=e.toLowerCase().replace(/[^a-z0-9 -]/gi,"").replace(/ /gi,"-"),e=e.substr(0,50)},self.depthClass=function(e){return self.options.levelClass.replace("%",e-(self.starting_depth-1))},self.addSpacing=function(){var t=self.$headings.filter(":first").position().top;self.$headings.each(function(s){var l=self.$el.find("a:eq("+s+")"),i=(e(this).position().top-t)/(self.$scope.height()-t)*self.$el.height();l.css({position:"absolute",top:i})})},self.init()},e.TableOfContents.defaultOptions={startLevel:1,depth:3,tieredList:!0,levelClass:"toc-depth-%",levelText:"%",topLinks:!1,linkifyHeaders:!0,topLinkClass:"toc-top-link",topBodyId:"toc-top",proportionateSpacing:!1},e.fn.tableOfContents=function(t,s){return this.each(function(){var l=new e.TableOfContents(this,t,s);delete l,e('[data-spy="scroll"]').each(function(){e(this).scrollspy("refresh")})})}})(jQuery),$(document).ready(function(){$("ul#toc").tableOfContents(null,{startLevel:2,tieredList:!1})});